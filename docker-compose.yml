version: '3.9'

services:
  nginx:
    image: nginx:alpine
    ports:
      - '80:80'
      - '443:443'
    volumes:
      - './nginx.conf:/etc/nginx/conf.d/default.conf'
	  - './:/var/www/:ro'
      - './fullchain.pem:/etc/letsencrypt/live/taxon.specifysoftware.org/fullchain.pem:ro'
      - './privkey.pem:/etc/letsencrypt/live/taxon.specifysoftware.org/privkey.pem:ro'
    networks:
      - nginx
    depends_on:
      - php

  php:
    build:
      context: ./
      target: back_end
      args:
		# TODO:
		# Whether to print error messages and warnings. Can be FALSE or TRUE
        DEVELOPMENT: 'FALSE'
        # TODO:
        # Address the website would be served on
        LINK: 'http://localhost/'
	volumes:
	  - './working-dir/:/home/specify/working-dir/'
	    # TODO:
        # Location to the place where all of your access.log files are located.
	    # Make sure the web server has read permissions to all the files in this folder.
	  - './access-logs/:/home/specify/access-logs/'
	  - './:/home/specify/sp7-stats/'
    networks:
      - nginx

networks:
  nginx:
    driver: bridge

volumes:
  database:
  taxa_tree_gbif:
  taxa_tree_gbif_working_dir: